Проект парсера сайта [darksky.net](https://darksky.net) для получения прогноза погоды в Санкт-Петербурге
или информации о погоде за прошедшие дни. 

[weather.py](https://github.com/kirillsdnv/weather_parser#:~:text=23%20minutes%20ago-,weather.py,-project%20files%20added) запускающий проект файл.
Диапазон дней для получения погоды всегда передаётся с помощью аргументов строки, которые обрабатываются модулем argparse, в методе `__parse_the_dates_range`.

Строка должна иметь следующий вид: `'-f 2022-06-16 -l 2022-06-17 -c -p'`. Первые два обязательных параметра - даты, в формате yyyy-mm-dd. После -f следует день, начиная с которого требуется получить данные о погоде, после -l - правая граница диапазона дат. Остальные параметры необязательны: если указать -c, то в консоли будет выведена информация о погоде; если указать с строке -p, то будет сделано изображение (открытка) с соответствующей иконкой и фоном (при облачной погоде фон будет серо-белым и т.д.). Эта строка передаётся либо как аргумент при инициализации объекта класса `Manager('-f 2022-06-16 -l 2022-06-17 -c -p')` или при запуске файла через командную строку.
![image](https://user-images.githubusercontent.com/80598880/172331355-c2652a27-2259-4293-97f2-22b2c72bee1e.png)

_Пример запуска проекта с помощью командной строки._

![16_jun](https://user-images.githubusercontent.com/80598880/172331854-10f1fa83-0fc7-46bb-bcfa-ea259cbf5c67.jpg)
![image](https://user-images.githubusercontent.com/80598880/172332486-76b436a7-bec5-4f25-8485-0d87093740b7.png)

_Результат работы проекта с данными параметрами: изображение с данными о погоде 16 июня 2022 года в Санкт-Петербурге и те же данные в текстовом виде, выведенные в консоль._

Класс `Manager` обеспечивает работу всего проекта:
 - метод `run` запускает все необходимые для работы проекта модули и вспомогательные функции
 - `get_weather_data` - формирует и запускает потоки: каждый поток получает информарцию о погоде с сайта за конкретный день

Другие модули проекта и их функции:
  - [weather_forecast.py](https://github.com/kirillsdnv/weather_parser/blob/main/weather_forecast.py) обеспечивает получение информации о погоде: с помощью инструментов парсинга и регулярных выражений извлекает из html-кода веб-страницы тип погоды (солнечно, облачно и т.д.) и температуру. Отдельный метод соотносит тип погоды с тем, какая иконка и какой цвет фона ему соответствует. Все эти данные с помощью инструмента Lock формируются в список словарей для последующего занесения в базу данных.
  - [base.py](https://github.com/kirillsdnv/weather_parser#:~:text=1%20hour%20ago-,base.py,-project%20files%20added) содержит модель базы данных и класс, обеспечивающий работу с базой данных: сохранение и извлечение данных, их подготовка для передачи в модуль фомирования изображений -- все эти операции обеспечивают методы класса `DatabaseUpdater`.
  - [postcard.py](https://github.com/kirillsdnv/weather_parser/blob/main/postcard.py) реализует всё, связанное с формированием открыток: обрезает шаблон открытки, рисует градиент, накладывает иконку и текст с информацией о погоде, сохраняет изображения в указанные директории и обеспечивает их отображение.
  - [settings.py](https://github.com/kirillsdnv/weather_parser#:~:text=1%20hour%20ago-,settings.py,-settings%20file) содержит служебные данные и вспомогательные функции. Директории, форматы дат, данные для формирования открыток и тестирования проекта.
